/**
 *****************************************************************************************************
  * @copyright	(c)  Shenzhen Saiyuan Microelectronics Co., Ltd
  * @file	         main.c
  * @author	 
  * @version 	
  * @date	
  * @brief	         
  * @details         Contains the MCU initialization function and its H file
 *****************************************************************************************************
 * @attention
 *
 *****************************************************************************************************
 */
/*******************Includes************************************************************************/

#include "SC_Init.h"
#include "SC_it.h"
#include "sc32f1xxx_btm.h"
#include "..\Drivers\SCDriver_list.h"
#include "HeadFiles\SysFunVarDefine.h"
#include "weight_sensor.h"
#include "key.h"
#include "buzzer.h"
#include "app_init.h"
#include "scale_manager.h"
#include "system_timer.h"
#include "key_handler.h"

/**************************************Generated by EasyCodeCube*************************************/
//Forbid editing areas between the labels !!!

/*************************************.Generated by EasyCodeCube.************************************/

/* 系统配置参数 */
const float OVERWEIGHT_LIMIT = 1000.0f;        // 1kg超重限制
const uint32_t OVERWEIGHT_CHECK_FREQ = 500;    // 500ms检查一次
const float ACTIVITY_THRESHOLD = 5.0f;         // 5g活动检测阈值
const uint32_t INACTIVITY_TIMEOUT = 60000;     // 60秒无操作超时(ms)

/**
  * @brief This function implements main function.
  * @note 
  * @param
  */
int main(void)
{
    /*<Generated by EasyCodeCube begin>*/
/*<UserCodeStart>*//*<SinOne-Tag><36>*/
    IcResourceInit();
    Application_Init();
    /*<UserCodeEnd>*//*<SinOne-Tag><36>*/
/*<UserCodeStart>*//*<SinOne-Tag><4>*/
    /*****MainLoop*****/
    while(1)
    {
        /*<UserCodeStart>*//*<SinOne-Tag><14>*/
        /***User program***/
        // 更新时间
        SystemTimer_Update();
        
        // 1. 更新重量显示
        UpdateWeightDisplay();
        
        // 2. 实时超重检查
        OverweightCheck_RealTime();
        
        // 3. 检测重量变化活动
        CheckWeightActivity();
        
        // 4. 检查60秒无操作超时
        CheckInactivityTimeout();
        /*<UserCodeEnd>*//*<SinOne-Tag><14>*/
/*<Begin-Inserted by EasyCodeCube for Condition>*/
    }
    /*<UserCodeEnd>*//*<SinOne-Tag><4>*/
/*<Generated by EasyCodeCube end>*/
}
